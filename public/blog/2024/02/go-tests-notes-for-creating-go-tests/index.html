<!DOCTYPE html>
<html lang="en-us">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description" content=" I explain Goroutines and Channels and how to apply them from basic concepts to more advanced use cases. - Andrew M McCall is a Golang, Javascript, PHP, SQL web developer living in Traverse City, MI ">
        <title>Go Tests Notes for Creating Go Tests -Andrew M McCall - Golang, Javascript, PHP, Wordpress</title>
	
	
	<link rel="stylesheet" type="text/css" href="//localhost:1313/css/index.css">
	<script src="/scripts/index.js" type="module" defer></script>

</head>
<body class="single">
	<div class="wrapper">
		<header class="article-header">
			<nav class="main-nav">
				
					

				<a href="/about/" title="About Me" rel="">About Me</a>	
				

				<a href="/blog/" title="Blog" rel="">Blog</a>	
				

				<a href="/contact/" title="Contact" rel="">Contact</a>	
				

				<a href="/projects/" title="Projects" rel="">Projects</a>	
				
				
			</nav>
			<h1 class="article-title">Go Tests Notes for Creating Go Tests</h1>
			<div class="author-byline">
				<strong>By: </strong><span>Andrew M McCall</span>
						<br />
						<strong>Published: </strong><span>Feb 01, 2024</span>

						
						
					
						
							<br />
							<strong> Categories: </strong>
							<ul class="categories">
							
									<li>
										<a href="/categories/software-testing/">Software Testing</a>
									</li>

							
						</ul>
						

						
							<br />
							<strong> Tags: </strong>
							<ul class="categories">
							
									<li>
										<a href="/tags/go/">Go</a>
									</li>
                        <span class="divider"></span>

							
									<li>
										<a href="/tags/testing/">Testing</a>
									</li>
                        <span class="divider"></span>

							
						</ul>
						

			</div>
				<nav aria-label="breadcrumb" class="breadcrumb">
  				<ol class="breadcrumbs">
  				  
  				    <li>
  				      <a href="//localhost:1313/">Home</a>
  				    </li>
  				  
  				    <li>
  				      <a href="//localhost:1313/blog/">Blog</a>
  				    </li>
  				  
  				  <li class="active">
  				    <a aria-current="page" href="//localhost:1313/blog/2024/02/go-tests-notes-for-creating-go-tests/">Go Tests Notes for Creating Go Tests</a>
  				  </li>
  				</ol>
			</nav>
			</header>
		<div class="container">
				<main class="main-content">
				<article id="mainContent" class="main-content__content">
					<h1 id="check-coverage">Check Coverage</h1>
<pre tabindex="0"><code>go test -cover .

//  create coverage profile
go test -coverprofile=coverage.out

// see coverage as html document
go tool cover -html=coverage.out
</code></pre><h1 id="create-a-new-test">Create A New Test</h1>
<p>For a simple program, that only uses a <code>main.go</code> file, we would create a new file next to the <code>main.go</code> file called <code>main_test.go</code>.</p>
<h2 id="how-to-write-a-simple-test-in-go">How To Write A Simple Test In Go</h2>
<pre tabindex="0"><code>// inside of main_test.go

func Test_IsPrime(t *testing.T) {
	primeTests := []struct {
		name     string
		testNum  int
		expected bool
		msg      string
	}{
		{&#34;prime&#34;, 17, true, &#34;17 is prime&#34;},
		{&#34;not prime&#34;, 20, false, &#34;20 is not prime&#34;},
		{&#34;prime&#34;, 23, true, &#34;23 is prime&#34;},
		{&#34;0&#34;, 0, false, &#34;0 is not prime&#34;},
		{&#34;1&#34;, 1, false, &#34;1 is not prime&#34;},
		{&#34;negative number&#34;, -1, false, &#34;-1 is not prime&#34;},
	}

	for _, tt := range primeTests {
		if got := isPrime(tt.testNum); got != tt.expected {
			t.Errorf(&#34;isPrime(%d) = %t - %s&#34;, tt.testNum, tt.expected, tt.msg)
		}
	}
}
</code></pre><p>This would be considered a table test.  What we are doing is creating a slice of structs that hold our test cases. We then iterate through the test cases and run the test for each case we want to test.</p>
<p>If there is an error, we can use <code>t.Errorf</code> to report the error.</p>
<h2 id="testing-user-input">Testing User Input</h2>
<pre tabindex="0"><code>func Test_prompt(t *testing.T) {
	// save a copy of os.Stdout
	oldOut := os.Stdout

	// create a read/write pipe
	r, w, _ := os.Pipe()

	// set os.Stdout to our write pipe
	os.Stdout = w

	prompt()

	_ = w.Close()

	// reset os.Stdout to what it was before
	os.Stdout = oldOut

	// read the output of the prompt function from our read pipe

	out, _ := io.ReadAll(r)

	if string(out) != &#34;-&gt; &#34; {
		t.Errorf(&#34;prompt() = %s&#34;, string(out))
	}

}
</code></pre><p>To test user input, we are first storing the os.Stdout in a variable. We then creating a read/write pipe.  We take the written value of os.Stdout and store it in our write pipe.</p>
<p>We then call our <code>prompt()</code> function and send the value back to the read pipe.  Don&rsquo;t forget that we need to close the write pipe so we do not have a memory leak.</p>
<p>Now, we restore the value stored in oldOut to os.Stdout.  From there, we are just using the <code>io.ReadAll(r)</code> function to read the value.</p>
<p>We then cast out to a string because it is being sent back to us as a slice of bytes.</p>
<p>Finally, if the result of <code>string(out)</code> does not equal our expected prompt value, we create a new <code>t.Errorf</code> to handle the error.</p>
<p><strong>Note:</strong> we can use a similar method to test <code>fmt.Println()</code>.  The difference, however, is that near the end, where we test the string, we are calling <code>!strings.Contains()</code> and throwing a new <code>t.Errorf()</code> if the test fails.</p>
<h2 id="testing">Testing</h2>

				</article>
			</main>
			<aside class="sidebar"> 
			
		<section class="author-card">
		<div class="author-card__inner-row">
			<div class="author-card__inner-row__portrait">
				<div class="outer-portrait">
					<div class="inner-portrait">
						<img data-src="/images/portrait.webp" class="logo" alt="portrait of author" height="300" width="300" loading="lazy" decoding="async">
					</div>
				</div>
			</div>
			<div class="author-meta">
					<h3 class="author-meta__name">Andrew M McCall</h3>
					<span class="role">Web Developer</span>
					<div class="meta-box  ">
						<time class="publish-date" datetime="2024-02-01 20:48:51 -0500 EST">Feb 01, 2024</time>
					<span id="readTime" class="read-time">-</span>
					</div>
					
					 
					<div class="social-icons">
						
						<a href="/contact" title=" email  - social " rel="noreferrer noopener"><img data-src="/images/icons/email-50x50.svg" class="logo" alt="email - social icon" loading="lazy" decoding="async" height="35" width="35"></a>
						
						<a href="https://indieweb.social/@elkcityhazard" title=" @elkcityhazard  - social " rel="noreferrer noopener"><img data-src="/images/icons/logo-purple.png" class="logo" alt="mastodon - social icon" loading="lazy" decoding="async" height="35" width="35"></a>
						
						<a href="https://book.andrew-mccall.com/" title=" introwise  - social " rel="noreferrer noopener"><img data-src="/images/icons/logo-small-transparent.png" class="logo" alt="introwise - social icon" loading="lazy" decoding="async" height="35" width="35"></a>
						
						<a href="https://codeberg.org/elkcityhazard" title=" codeberg  - social " rel="noreferrer noopener"><img data-src="/images/icons/codeberg.png" class="logo" alt="codeberg - social icon" loading="lazy" decoding="async" height="35" width="35"></a>
						
						<a href="https://gitlab.com/elkcityhazard" title=" gitlab  - social " rel="noreferrer noopener"><img data-src="/images/icons/gitlab.png" class="logo" alt="gitlab - social icon" loading="lazy" decoding="async" height="35" width="35"></a>
						
					</div>
					
					
				</div>
                    
		</div>
    
</section>
 
                        

			<section class="toc">
	<h3>Table Of Contents</h3>
	<nav id="TableOfContents">
  <ul>
    <li><a href="#how-to-write-a-simple-test-in-go">How To Write A Simple Test In Go</a></li>
    <li><a href="#testing-user-input">Testing User Input</a></li>
    <li><a href="#testing">Testing</a></li>
  </ul>
</nav>
</section> 
		</aside>
		</div>
		
		<section class="featured">
			<h2 class="featured__title">My Recent Posts</h2>
			<div class="featured__articles">
				

				
				<div class="featured-card">
					<a href="/blog/2024/02/go-tests-notes-for-creating-go-tests/" title="Go Tests Notes for Creating Go Tests-Go has powerful concurrency tools fully baked into the programming Language.  This post aims to explain go routines and channels so you can get started using them in your own projects.">
					<h2 class="featured-card__title">Go Tests Notes for Creating Go Tests</h2>
					</a>
					<div class="featured-card__byline">
						<strong>By: </strong><span>Andrew M McCall</span>
						<br />
						<strong>Published: </strong><span>Feb 01, 2024</span>
						
					</div>
					<div class="featured-card__content">Go has powerful concurrency tools fully baked into the programming Language.  This post aims to explain go routines and channels so you can get started using them in your own projects.</div>
					<a href="/blog/2024/02/go-tests-notes-for-creating-go-tests/" class="featured-card__button " title="Go Tests Notes for Creating Go Tests -Go has powerful concurrency tools fully baked into the programming Language.  This post aims to explain go routines and channels so you can get started using them in your own projects.">Go Tests Notes for Creating Go Tests</a>
				</div>
				
				<div class="featured-card">
					<a href="/blog/2024/01/javascript-image-animation-effects/" title="Javascript Image Animation Effects-I walk through the process of using html canvas, javascript, and css to manipulate an image.">
					<h2 class="featured-card__title">Javascript Image Animation Effects</h2>
					</a>
					<div class="featured-card__byline">
						<strong>By: </strong><span>Andrew M McCall</span>
						<br />
						<strong>Published: </strong><span>Jan 27, 2024</span>
						
					</div>
					<div class="featured-card__content">I walk through the process of using html canvas, javascript, and css to manipulate an image.</div>
					<a href="/blog/2024/01/javascript-image-animation-effects/" class="featured-card__button " title="Javascript Image Animation Effects -I walk through the process of using html canvas, javascript, and css to manipulate an image.">Javascript Image Animation Effects</a>
				</div>
				
				<div class="featured-card">
					<a href="/blog/2024/01/sending-emails-with-go-routines/" title="Sending Emails With Go Routines-Transactional emails and token creation are expensive operations.  Let&rsquo;s explore how we can offload these to the background using channels and go routines.">
					<h2 class="featured-card__title">Sending Emails With Go Routines</h2>
					</a>
					<div class="featured-card__byline">
						<strong>By: </strong><span>Andrew M McCall</span>
						<br />
						<strong>Published: </strong><span>Jan 15, 2024</span>
						
					</div>
					<div class="featured-card__content">Transactional emails and token creation are expensive operations.  Let&rsquo;s explore how we can offload these to the background using channels and go routines.</div>
					<a href="/blog/2024/01/sending-emails-with-go-routines/" class="featured-card__button " title="Sending Emails With Go Routines -Transactional emails and token creation are expensive operations.  Let&rsquo;s explore how we can offload these to the background using channels and go routines.">Sending Emails With Go Routines</a>
				</div>
				
			

				
			

				
			

				
			

				
			

				
			

				
			

				
			

				
			

				
			

				
			

				
			

				
			

				
			

				
			

				
			

				
			

				
			

				
			

				
			

				
			

				
			

				
			

				
			

				
			

				
			

				
			

				
			

				
			

				
			

				
			

				
			

				
			

				
			

				
			

				
			

				
			

				
			

				
			
			</div>

			
		</section>

		<section class="featured">
			<h2 class="featured__title">My Recent Projects</h2>
			<div class="featured__articles">
				

				
			
			</div>

			
		</section>	
		<footer class="main-footer">
	<div class="main-footer__row">
		<div class="col">
			<a href="//localhost:1313/">
			<img data-src="/images/logo-small-transparent.png" class="logo" alt="logo" loading="lazy" decoding="async" height="200" width="200">
		</a>
		</div>
		<div class="col">
				<h4>Navigation</h4>
<nav class="footer-nav">
				
					

				<a href="/about/" title="About Me" rel="">About Me</a>	
				

				<a href="/blog/" title="Blog" rel="">Blog</a>	
				

				<a href="/contact/" title="Contact" rel="">Contact</a>	
				

				<a href="/projects/" title="Projects" rel="">Projects</a>	
				
				
			</nav>
		</div>
		<div class="col">
			
					 <h4>Connect</h4>
					<div class="social-icons footer">
						
						<a href="/contact" title=" email  - social " rel="noreferrer noopener"><img data-src="/images/icons/email-50x50.svg" alt="email social icon" class="logo" aria-label="email" loading="lazy" decoding="async" height="45" width="45"></a>
						
						<a href="https://indieweb.social/@elkcityhazard" title=" @elkcityhazard  - social " rel="noreferrer noopener"><img data-src="/images/icons/logo-purple.png" alt="mastodon social icon" class="logo" aria-label="mastodon" loading="lazy" decoding="async" height="45" width="45"></a>
						
						<a href="https://book.andrew-mccall.com/" title=" introwise  - social " rel="noreferrer noopener"><img data-src="/images/icons/logo-small-transparent.png" alt="introwise social icon" class="logo" aria-label="introwise" loading="lazy" decoding="async" height="45" width="45"></a>
						
						<a href="https://codeberg.org/elkcityhazard" title=" codeberg  - social " rel="noreferrer noopener"><img data-src="/images/icons/codeberg.png" alt="codeberg social icon" class="logo" aria-label="codeberg" loading="lazy" decoding="async" height="45" width="45"></a>
						
						<a href="https://gitlab.com/elkcityhazard" title=" gitlab  - social " rel="noreferrer noopener"><img data-src="/images/icons/gitlab.png" alt="gitlab social icon" class="logo" aria-label="gitlab" loading="lazy" decoding="async" height="45" width="45"></a>
						
					</div>
					
					
		</div>
			
	</div>
	
	<p class="center">&copy; <span id="currentYear">2024</span> - <a href="//localhost:1313/">Andrew M McCall - Traverse City Web Developer</a> </p>
</footer>


	</div>
</body>
</html>
